<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Triple Timer</title>
<style>
    body {
        background-color: transparent;
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
    }
    .container {
        display: flex;
        gap: 15px;
    }
    .timer {
        background-color: #fff7d1;
        border-radius: 10px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        padding: 10px;
        text-align: center;
        width: 140px;
    }
    .timer input[type="text"] {
        width: 90%;
        padding: 3px;
        margin-bottom: 8px;
        font-size: 14px;
        border-radius: 6px;
        border: 1px solid #ccc;
        text-align: center;
    }
    .time-display {
        font-size: 36px;
        font-weight: bold;
        margin-bottom: 8px;
    }
    .controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 5px;
        margin-bottom: 8px;
    }
    button {
        border: none;
        padding: 6px 10px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        background-color: #fff1a8;
        transition: background 0.3s;
    }
    button:hover {
        background-color: #ffe76a;
    }
    .cancel-btn {
        display: block;
        margin: 6px auto 0 auto;
        width: 70%;
    }
</style>
</head>
<body>
<div class="container">
    <div class="timer">
        <input type="text" placeholder="Timer 1">
        <div class="time-display" id="time1">00:00</div>
        <div class="controls">
            <button>-</button>
            <button onclick="startTimer(1)">Start</button>
            <button>+</button>
        </div>
        <button class="cancel-btn" onclick="resetTimer(1)">Cancel</button>
    </div>
    <div class="timer">
        <input type="text" placeholder="Timer 2">
        <div class="time-display" id="time2">00:00</div>
        <div class="controls">
            <button>-</button>
            <button onclick="startTimer(2)">Start</button>
            <button>+</button>
        </div>
        <button class="cancel-btn" onclick="resetTimer(2)">Cancel</button>
    </div>
    <div class="timer">
        <input type="text" placeholder="Timer 3">
        <div class="time-display" id="time3">00:00</div>
        <div class="controls">
            <button>-</button>
            <button onclick="startTimer(3)">Start</button>
            <button>+</button>
        </div>
        <button class="cancel-btn" onclick="resetTimer(3)">Cancel</button>
    </div>
</div>

<script>
(function() {
  const timers = [0,0,0];          // seconds for each timer
  const countdowns = [null,null,null];
  const holdIntervals = [null,null,null];

  function formatTime(t) {
    const m = Math.floor(t/60);
    const s = t%60;
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }

  window.updateDisplay = function(index) {
    const el = document.getElementById('time' + index);
    if(el) el.textContent = formatTime(timers[index-1]);
  }

  window.changeTime = function(index, amount) {
    timers[index-1] = Math.max(0, timers[index-1] + amount);
    updateDisplay(index);
  }

  window.startTimer = function(index) {
    const idx = index-1;
    if(countdowns[idx] || timers[idx]<=0) return;
    countdowns[idx] = setInterval(()=>{
      if(timers[idx]>0){
        timers[idx]--;
        updateDisplay(index);
      }
      if(timers[idx]<=0){
        clearInterval(countdowns[idx]);
        countdowns[idx]=null;
        const nameInput = document.querySelectorAll('.timer input')[idx];
        const name = (nameInput && nameInput.value.trim()) || `Timer ${index}`;
        try{ alert(`${name} finished!`);}catch(e){}
      }
    },1000);
  }

  window.resetTimer = function(index) {
    const idx = index-1;
    if(countdowns[idx]) { clearInterval(countdowns[idx]); countdowns[idx]=null; }
    timers[idx]=0;
    updateDisplay(index);
  }

  document.querySelectorAll('.timer').forEach((timerEl,i)=>{
    const idx = i+1;
    const btns = timerEl.querySelectorAll('.controls button');
    if(!btns || btns.length<3) return;
    const minusBtn = btns[0];
    const plusBtn = btns[2];

    // прибираємо старі onclick
    minusBtn.removeAttribute('onclick');
    plusBtn.removeAttribute('onclick');

    function beginHold(amount){
      changeTime(idx,amount); // одразу один крок
      if(holdIntervals[i]) { clearInterval(holdIntervals[i]); holdIntervals[i]=null; }
      holdIntervals[i] = setInterval(()=>changeTime(idx,amount),150);
      const stopHandler = ()=>{
        if(holdIntervals[i]) { clearInterval(holdIntervals[i]); holdIntervals[i]=null; }
        window.removeEventListener('pointerup', stopHandler);
        window.removeEventListener('pointercancel', stopHandler);
      }
      window.addEventListener('pointerup', stopHandler);
      window.addEventListener('pointercancel', stopHandler);
    }

    minusBtn.addEventListener('pointerdown', e=>{ e.preventDefault(); beginHold(-30); });
    plusBtn.addEventListener('pointerdown', e=>{ e.preventDefault(); beginHold(30); });

    // одиночний клік теж додає/віднімає 30 секунд
    minusBtn.addEventListener('click', ()=>changeTime(idx,-30));
    plusBtn.addEventListener('click', ()=>changeTime(idx,30));

    updateDisplay(idx);
  });

})();
</script>
</body>
</html>
